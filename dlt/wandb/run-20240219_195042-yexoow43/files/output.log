
  0%|                                                                                                                                                                  | 0/2997 [00:00<?, ?it/s]

  0%|                                                                                                                                                        | 1/2997 [00:05<4:11:01,  5.03s/it]

  0%|                                                                                                                                                        | 2/2997 [00:09<3:44:42,  4.50s/it]

  0%|▏                                                                                                                                                       | 3/2997 [00:12<3:26:07,  4.13s/it]

  0%|▏                                                                                                                                                       | 4/2997 [00:16<3:19:21,  4.00s/it]

  0%|▎                                                                                                                                                       | 5/2997 [00:20<3:17:54,  3.97s/it]

  0%|▎                                                                                                                                                       | 6/2997 [00:24<3:15:33,  3.92s/it]

  0%|▎                                                                                                                                                       | 7/2997 [00:28<3:16:33,  3.94s/it]

  0%|▍                                                                                                                                                       | 8/2997 [00:32<3:14:56,  3.91s/it]

  0%|▍                                                                                                                                                       | 9/2997 [00:36<3:13:04,  3.88s/it]

  0%|▌                                                                                                                                                      | 10/2997 [00:39<3:10:08,  3.82s/it]

  0%|▌                                                                                                                                                      | 11/2997 [00:43<3:08:51,  3.79s/it]

  0%|▌                                                                                                                                                      | 12/2997 [00:47<3:13:02,  3.88s/it]

  0%|▋                                                                                                                                                      | 13/2997 [00:51<3:14:06,  3.90s/it]

  0%|▋                                                                                                                                                      | 14/2997 [00:55<3:20:01,  4.02s/it]
The background image is not RGBA
############### height가 1 보다 작음 ##################

  1%|▊                                                                                                                                                      | 15/2997 [00:59<3:10:31,  3.83s/it]
The background image is not RGBA
############### height가 1 보다 작음 ##################

  1%|▊                                                                                                                                                      | 16/2997 [01:02<3:04:18,  3.71s/it]
The background image is not RGBA

  1%|▊                                                                                                                                                      | 17/2997 [01:06<3:00:07,  3.63s/it]
The background image is not RGBA

  1%|▉                                                                                                                                                      | 18/2997 [01:09<2:57:04,  3.57s/it]

  1%|▉                                                                                                                                                      | 19/2997 [01:12<2:54:30,  3.52s/it]

  1%|█                                                                                                                                                      | 20/2997 [01:16<2:52:42,  3.48s/it]
The background image is not RGBA

  1%|█                                                                                                                                                      | 21/2997 [01:19<2:51:45,  3.46s/it]
The background image is not RGBA
############### height가 1 보다 작음 ##################

  1%|█                                                                                                                                                      | 22/2997 [01:23<2:51:05,  3.45s/it]
The background image is not RGBA

  1%|█▏                                                                                                                                                     | 23/2997 [01:26<2:51:41,  3.46s/it]
The background image is not RGBA
############### height가 1 보다 작음 ##################

  1%|█▏                                                                                                                                                     | 24/2997 [01:29<2:50:13,  3.44s/it]

  1%|█▎                                                                                                                                                     | 25/2997 [01:33<2:52:49,  3.49s/it]

  1%|█▎                                                                                                                                                     | 26/2997 [01:37<2:55:23,  3.54s/it]

  1%|█▎                                                                                                                                                     | 27/2997 [01:41<2:59:14,  3.62s/it]

  1%|█▍                                                                                                                                                     | 28/2997 [01:44<3:00:43,  3.65s/it]

  1%|█▍                                                                                                                                                     | 29/2997 [01:48<3:06:45,  3.78s/it]

  1%|█▌                                                                                                                                                     | 30/2997 [01:52<3:09:57,  3.84s/it]

  1%|█▌                                                                                                                                                     | 31/2997 [01:56<3:11:33,  3.87s/it]

  1%|█▌                                                                                                                                                     | 32/2997 [02:00<3:14:51,  3.94s/it]

  1%|█▋                                                                                                                                                     | 33/2997 [02:04<3:14:52,  3.94s/it]

  1%|█▋                                                                                                                                                     | 34/2997 [02:08<3:15:11,  3.95s/it]

  1%|█▊                                                                                                                                                     | 35/2997 [02:12<3:15:54,  3.97s/it]

  1%|█▊                                                                                                                                                     | 36/2997 [02:16<3:15:59,  3.97s/it]

  1%|█▊                                                                                                                                                     | 37/2997 [02:20<3:15:53,  3.97s/it]
The background image is not RGBA

  1%|█▉                                                                                                                                                     | 38/2997 [02:24<3:11:12,  3.88s/it]
The background image is not RGBA

  1%|█▉                                                                                                                                                     | 39/2997 [02:28<3:07:20,  3.80s/it]
The background image is not RGBA

  1%|██                                                                                                                                                     | 40/2997 [02:31<3:06:34,  3.79s/it]
The background image is not RGBA

  1%|██                                                                                                                                                     | 41/2997 [02:35<3:06:37,  3.79s/it]
The background image is not RGBA

  1%|██                                                                                                                                                     | 42/2997 [02:39<3:04:23,  3.74s/it]
The background image is not RGBA

  1%|██▏                                                                                                                                                    | 43/2997 [02:42<3:03:53,  3.74s/it]
The background image is not RGBA

  1%|██▏                                                                                                                                                    | 44/2997 [02:46<2:59:48,  3.65s/it]
The background image is not RGBA

  2%|██▎                                                                                                                                                    | 45/2997 [02:50<3:01:33,  3.69s/it]
The background image is not RGBA

  2%|██▎                                                                                                                                                    | 46/2997 [02:53<3:01:59,  3.70s/it]
The background image is not RGBA

  2%|██▎                                                                                                                                                    | 47/2997 [02:57<2:57:56,  3.62s/it]

  2%|██▍                                                                                                                                                    | 48/2997 [03:01<2:59:05,  3.64s/it]

  2%|██▍                                                                                                                                                    | 49/2997 [03:04<2:55:39,  3.58s/it]

  2%|██▌                                                                                                                                                    | 50/2997 [03:07<2:53:34,  3.53s/it]

  2%|██▌                                                                                                                                                    | 51/2997 [03:11<2:52:01,  3.50s/it]

  2%|██▌                                                                                                                                                    | 52/2997 [03:14<2:50:10,  3.47s/it]

  2%|██▋                                                                                                                                                    | 53/2997 [03:18<2:50:45,  3.48s/it]

  2%|██▋                                                                                                                                                    | 54/2997 [03:21<2:52:40,  3.52s/it]

  2%|██▊                                                                                                                                                    | 55/2997 [03:25<2:51:41,  3.50s/it]

  2%|██▊                                                                                                                                                    | 56/2997 [03:28<2:51:37,  3.50s/it]

  2%|██▊                                                                                                                                                    | 57/2997 [03:32<2:51:24,  3.50s/it]

  2%|██▉                                                                                                                                                    | 58/2997 [03:35<2:50:13,  3.48s/it]

  2%|██▉                                                                                                                                                    | 59/2997 [03:39<2:50:19,  3.48s/it]

  2%|███                                                                                                                                                    | 60/2997 [03:42<2:50:50,  3.49s/it]

  2%|███                                                                                                                                                    | 61/2997 [03:46<2:50:32,  3.49s/it]

  2%|███                                                                                                                                                    | 62/2997 [03:49<2:51:39,  3.51s/it]

  2%|███▏                                                                                                                                                   | 63/2997 [03:53<2:49:37,  3.47s/it]

  2%|███▏                                                                                                                                                   | 64/2997 [03:56<2:49:59,  3.48s/it]

  2%|███▎                                                                                                                                                   | 65/2997 [04:00<2:50:54,  3.50s/it]

  2%|███▎                                                                                                                                                   | 66/2997 [04:03<2:50:32,  3.49s/it]

  2%|███▍                                                                                                                                                   | 67/2997 [04:07<2:57:07,  3.63s/it]

  2%|███▍                                                                                                                                                   | 68/2997 [04:11<2:56:56,  3.62s/it]

  2%|███▍                                                                                                                                                   | 69/2997 [04:15<3:04:07,  3.77s/it]
  2%|███▌                                                                                                                                                   | 70/2997 [04:19<3:01:05,  3.71s/it]
Traceback (most recent call last):
  File "/home/mineslab-ubuntu/KDH_CAL2/dlt/inference.py", line 277, in <module>
    app.run(main)
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/absl/app.py", line 308, in run
    _run_main(main, args)
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/absl/app.py", line 254, in _run_main
    sys.exit(main(argv))
  File "/home/mineslab-ubuntu/KDH_CAL2/dlt/inference.py", line 167, in main
    pred_geometry = sample_from_model(batch, model, config.device, noise_scheduler)*batch["padding_mask"][:, :, :4]
  File "/home/mineslab-ubuntu/KDH_CAL2/dlt/inference.py", line 58, in sample_from_model
    geometry_pred = model(batch, noisy_batch, timesteps=t)
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/mineslab-ubuntu/KDH_CAL2/dlt/models/CAL.py", line 108, in forward
    output = self.seqTransEncoder(xseq)[1:] #time step embedding 제외
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/torch/nn/modules/transformer.py", line 280, in forward
    output = mod(output, src_mask=mask, src_key_padding_mask=src_key_padding_mask_for_layers)
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/torch/nn/modules/transformer.py", line 538, in forward
    x = self.norm1(x + self._sa_block(x, src_mask, src_key_padding_mask))
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/torch/nn/modules/transformer.py", line 546, in _sa_block
    x = self.self_attn(x, x, x,
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/torch/nn/modules/activation.py", line 1167, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/torch/nn/functional.py", line 5097, in multi_head_attention_forward
    k = k.contiguous().view(k.shape[0], bsz * num_heads, head_dim).transpose(0, 1)
KeyboardInterrupt