



Epoch 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:19<00:00, 13.44it/s, loss=0.074, lr=4.7e-5, step=47]I0222 00:30:28.402866 139865278460288 cal_trainer2.py:311] Epoch 0, Avg Validation Loss: 0.07233800242344539, Avg Mean IoU: 0.07853376120328903
Epoch 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:39<00:00,  1.19it/s, loss=0.074, lr=4.7e-5, step=47]
I0222 00:30:28.403824 139865278460288 logging.py:61] Saving current state to logs/test/checkpoints/checkpoint-0/
W0222 00:30:28.406092 139865278460288 logging.py:61] Removed shared tensor {'embed_timestep.seq_pos_enc.pe'} while saving. This should be OK, but check by verifying that you don't receive any warning while reloading
I0222 00:30:28.618993 139865278460288 logging.py:61] Model weights saved in logs/test/checkpoints/checkpoint-0/model.safetensors
I0222 00:30:28.960448 139865278460288 logging.py:61] Optimizer state saved in logs/test/checkpoints/checkpoint-0/optimizer.bin
I0222 00:30:28.960984 139865278460288 logging.py:61] Scheduler state saved in logs/test/checkpoints/checkpoint-0/scheduler.bin
I0222 00:30:28.961268 139865278460288 logging.py:61] Sampler state for dataloader 0 saved in logs/test/checkpoints/checkpoint-0/sampler.bin
I0222 00:30:28.961402 139865278460288 logging.py:61] Sampler state for dataloader 1 saved in logs/test/checkpoints/checkpoint-0/sampler_1.bin
I0222 00:30:28.963597 139865278460288 logging.py:61] Random states saved in logs/test/checkpoints/checkpoint-0/random_states_0.pkl
I0222 00:30:29.163495 139865278460288 cal_trainer2.py:347] Saving checkpoint to logs/test/checkpoints/checkpoint-0/
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.53it/s, loss=0.0748, lr=9.4e-5, step=94]I0222 00:30:32.918591 139865278460288 cal_trainer2.py:311] Epoch 1, Avg Validation Loss: 0.07232075929641724, Avg Mean IoU: 0.09050040692090988
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.52it/s, loss=0.0748, lr=9.4e-5, step=94]

Epoch 2: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.39it/s, loss=0.0756, lr=0.000141, step=141]I0222 00:30:36.670141 139865278460288 cal_trainer2.py:311] Epoch 2, Avg Validation Loss: 0.06862878054380417, Avg Mean IoU: 0.09706835448741913
Epoch 2: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.53it/s, loss=0.0756, lr=0.000141, step=141]

Epoch 3: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.67it/s, loss=0.0537, lr=0.000188, step=188]I0222 00:30:40.370837 139865278460288 cal_trainer2.py:311] Epoch 3, Avg Validation Loss: 0.05417505279183388, Avg Mean IoU: 0.08761123567819595
Epoch 3: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.71it/s, loss=0.0537, lr=0.000188, step=188]

Epoch 4: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.57it/s, loss=0.0533, lr=0.000235, step=235]I0222 00:30:44.111660 139865278460288 cal_trainer2.py:311] Epoch 4, Avg Validation Loss: 0.06229668358961741, Avg Mean IoU: 0.0816693902015686
Epoch 4: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.57it/s, loss=0.0533, lr=0.000235, step=235]

Epoch 5: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.53it/s, loss=0.0503, lr=0.000282, step=282]I0222 00:30:47.809931 139865278460288 cal_trainer2.py:311] Epoch 5, Avg Validation Loss: 0.04831882442037264, Avg Mean IoU: 0.10772667825222015
Epoch 5: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.71it/s, loss=0.0503, lr=0.000282, step=282]

Epoch 6: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.54it/s, loss=0.0557, lr=0.000329, step=329]I0222 00:30:51.557969 139865278460288 cal_trainer2.py:311] Epoch 6, Avg Validation Loss: 0.04489032054940859, Avg Mean IoU: 0.11015136539936066
Epoch 6: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.55it/s, loss=0.0557, lr=0.000329, step=329]

Epoch 7: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.56it/s, loss=0.0437, lr=0.000376, step=376]I0222 00:30:55.258990 139865278460288 cal_trainer2.py:311] Epoch 7, Avg Validation Loss: 0.04330408200621605, Avg Mean IoU: 0.10382714122533798
Epoch 7: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.70it/s, loss=0.0437, lr=0.000376, step=376]
Epoch 8: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.77it/s, loss=0.0409, lr=0.000423, step=423]I0222 00:30:58.956166 139865278460288 cal_trainer2.py:311] Epoch 8, Avg Validation Loss: 0.04263307030002276, Avg Mean IoU: 0.11659332364797592
Epoch 8: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.72it/s, loss=0.0409, lr=0.000423, step=423]

Epoch 9: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.52it/s, loss=0.0401, lr=0.00047, step=470]I0222 00:31:02.689897 139865278460288 cal_trainer2.py:311] Epoch 9, Avg Validation Loss: 0.04590654745697975, Avg Mean IoU: 0.1699259728193283
Epoch 9: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.59it/s, loss=0.0401, lr=0.00047, step=470]

Epoch 10: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.45it/s, loss=0.036, lr=0.000517, step=517]I0222 00:31:06.419373 139865278460288 cal_trainer2.py:311] Epoch 10, Avg Validation Loss: 0.03929329042633375, Avg Mean IoU: 0.12593954801559448
Epoch 10: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.61it/s, loss=0.036, lr=0.000517, step=517]

Epoch 11: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.17it/s, loss=0.0431, lr=0.000564, step=564]I0222 00:31:10.204131 139865278460288 cal_trainer2.py:311] Epoch 11, Avg Validation Loss: 0.038564263532559075, Avg Mean IoU: 0.1482546478509903
Epoch 11: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.42it/s, loss=0.0431, lr=0.000564, step=564]

Epoch 12: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.54it/s, loss=0.0409, lr=0.000611, step=611]I0222 00:31:13.897802 139865278460288 cal_trainer2.py:311] Epoch 12, Avg Validation Loss: 0.04054652526974678, Avg Mean IoU: 0.1495087891817093
Epoch 12: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.73it/s, loss=0.0409, lr=0.000611, step=611]

Epoch 13: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.26it/s, loss=0.0416, lr=0.000658, step=658]I0222 00:31:17.722682 139865278460288 cal_trainer2.py:311] Epoch 13, Avg Validation Loss: 0.04040606568257014, Avg Mean IoU: 0.1482311338186264
Epoch 13: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.29it/s, loss=0.0416, lr=0.000658, step=658]

Epoch 14: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.10it/s, loss=0.0403, lr=0.000705, step=705]I0222 00:31:21.548118 139865278460288 cal_trainer2.py:311] Epoch 14, Avg Validation Loss: 0.038792947928110756, Avg Mean IoU: 0.15995389223098755
Epoch 14: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.29it/s, loss=0.0403, lr=0.000705, step=705]
Epoch 15: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 14.85it/s, loss=0.0348, lr=0.000752, step=752]I0222 00:31:25.313819 139865278460288 cal_trainer2.py:311] Epoch 15, Avg Validation Loss: 0.04061399772763252, Avg Mean IoU: 0.12751404941082
Epoch 15: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.49it/s, loss=0.0348, lr=0.000752, step=752]

Epoch 16: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.13it/s, loss=0.0372, lr=0.000799, step=799]I0222 00:31:29.117776 139865278460288 cal_trainer2.py:311] Epoch 16, Avg Validation Loss: 0.0431495246787866, Avg Mean IoU: 0.16235892474651337
Epoch 16: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.36it/s, loss=0.0372, lr=0.000799, step=799]

Epoch 17: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.57it/s, loss=0.045, lr=0.000846, step=846]I0222 00:31:32.839196 139865278460288 cal_trainer2.py:311] Epoch 17, Avg Validation Loss: 0.03993804007768631, Avg Mean IoU: 0.12796717882156372
Epoch 17: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.64it/s, loss=0.045, lr=0.000846, step=846]

Epoch 18: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.60it/s, loss=0.0338, lr=0.000893, step=893]I0222 00:31:36.597347 139865278460288 cal_trainer2.py:311] Epoch 18, Avg Validation Loss: 0.041578229516744614, Avg Mean IoU: 0.17052915692329407
Epoch 18: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.51it/s, loss=0.0338, lr=0.000893, step=893]

Epoch 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.27it/s, loss=0.0405, lr=0.00094, step=940]I0222 00:31:40.369679 139865278460288 cal_trainer2.py:311] Epoch 19, Avg Validation Loss: 0.04351410766442617, Avg Mean IoU: 0.11412591487169266
Epoch 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.46it/s, loss=0.0405, lr=0.00094, step=940]

Epoch 20: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.45it/s, loss=0.0468, lr=0.000987, step=987]I0222 00:31:44.100762 139865278460288 cal_trainer2.py:311] Epoch 20, Avg Validation Loss: 0.0440148301422596, Avg Mean IoU: 0.13710744678974152
Epoch 20: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.60it/s, loss=0.0468, lr=0.000987, step=987]

Epoch 21: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.33it/s, loss=0.0601, lr=0.001, step=1034]I0222 00:31:47.873027 139865278460288 cal_trainer2.py:311] Epoch 21, Avg Validation Loss: 0.06457740813493729, Avg Mean IoU: 0.06633386015892029
Epoch 21: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.47it/s, loss=0.0601, lr=0.001, step=1034]

Epoch 22: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.43it/s, loss=0.0881, lr=0.001, step=1081]I0222 00:31:51.631605 139865278460288 cal_trainer2.py:311] Epoch 22, Avg Validation Loss: 0.08002223074436188, Avg Mean IoU: 0.0716187059879303
Epoch 22: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.51it/s, loss=0.0881, lr=0.001, step=1081]

Epoch 23: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.62it/s, loss=0.0757, lr=0.001, step=1128]I0222 00:31:55.311798 139865278460288 cal_trainer2.py:311] Epoch 23, Avg Validation Loss: 0.07934085776408513, Avg Mean IoU: 0.06847644597291946
Epoch 23: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.78it/s, loss=0.0757, lr=0.001, step=1128]
Epoch 24: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.54it/s, loss=0.0757, lr=0.001, step=1175]I0222 00:31:59.061375 139865278460288 cal_trainer2.py:311] Epoch 24, Avg Validation Loss: 0.07644215722878774, Avg Mean IoU: 0.05543654039502144
Epoch 24: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.54it/s, loss=0.0757, lr=0.001, step=1175]

Epoch 25: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.67it/s, loss=0.0739, lr=0.001, step=1222]I0222 00:32:02.759964 139865278460288 cal_trainer2.py:311] Epoch 25, Avg Validation Loss: 0.07709816594918568, Avg Mean IoU: 0.07098738104104996
Epoch 25: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.71it/s, loss=0.0739, lr=0.001, step=1222]

Epoch 26: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.61it/s, loss=0.0747, lr=0.001, step=1269]I0222 00:32:06.526194 139865278460288 cal_trainer2.py:311] Epoch 26, Avg Validation Loss: 0.07577620198329289, Avg Mean IoU: 0.060705602169036865
Epoch 26: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.49it/s, loss=0.0747, lr=0.001, step=1269]

Epoch 27: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.60it/s, loss=0.0749, lr=0.001, step=1316]I0222 00:32:10.240251 139865278460288 cal_trainer2.py:311] Epoch 27, Avg Validation Loss: 0.07414454221725464, Avg Mean IoU: 0.07603009790182114
Epoch 27: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.66it/s, loss=0.0749, lr=0.001, step=1316]

Epoch 28: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.43it/s, loss=0.0759, lr=0.001, step=1363]I0222 00:32:13.954639 139865278460288 cal_trainer2.py:311] Epoch 28, Avg Validation Loss: 0.07377055535713832, Avg Mean IoU: 0.07338074594736099
Epoch 28: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.66it/s, loss=0.0759, lr=0.001, step=1363]

Epoch 29: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.31it/s, loss=0.0718, lr=0.001, step=1410]I0222 00:32:17.763167 139865278460288 cal_trainer2.py:311] Epoch 29, Avg Validation Loss: 0.07416936258474986, Avg Mean IoU: 0.0788567066192627
Epoch 29: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.35it/s, loss=0.0718, lr=0.001, step=1410]


Epoch 30: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:21<00:00, 13.76it/s, loss=0.0789, lr=0.001, step=1457]I0222 00:32:56.796313 139865278460288 cal_trainer2.py:311] Epoch 30, Avg Validation Loss: 0.08006120721499126, Avg Mean IoU: 0.08757031708955765
Epoch 30: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:39<00:00,  1.20it/s, loss=0.0789, lr=0.001, step=1457]

Epoch 31: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.09it/s, loss=0.0698, lr=0.001, step=1504]I0222 00:33:00.547670 139865278460288 cal_trainer2.py:311] Epoch 31, Avg Validation Loss: 0.07175274441639583, Avg Mean IoU: 0.0635654404759407
Epoch 31: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.53it/s, loss=0.0698, lr=0.001, step=1504]

Epoch 32: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.22it/s, loss=0.0705, lr=0.001, step=1551]I0222 00:33:04.343533 139865278460288 cal_trainer2.py:311] Epoch 32, Avg Validation Loss: 0.07161713639895122, Avg Mean IoU: 0.06954820454120636
Epoch 32: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.39it/s, loss=0.0705, lr=0.001, step=1551]

Epoch 33: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 13.22it/s, loss=0.0703, lr=0.001, step=1598]I0222 00:33:08.110931 139865278460288 cal_trainer2.py:311] Epoch 33, Avg Validation Loss: 0.07107426226139069, Avg Mean IoU: 0.07628993690013885
Epoch 33: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:03<00:00, 12.48it/s, loss=0.0703, lr=0.001, step=1598]
Epoch 34:   2%|█▉                                                                                           | 1/47 [00:00<00:11,  3.85it/s, loss=0.0668, lr=0.001, step=1599]Traceback (most recent call last):
  File "/home/mineslab-ubuntu/KDH_CAL2/dlt/main.py", line 119, in <module>
    app.run(main)
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/absl/app.py", line 308, in run
    _run_main(main, args)
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/absl/app.py", line 254, in _run_main
    sys.exit(main(argv))
  File "/home/mineslab-ubuntu/KDH_CAL2/dlt/main.py", line 94, in main
    TrainLoopCAL(accelerator=accelerator, model=model, diffusion=noise_scheduler,
  File "/home/mineslab-ubuntu/KDH_CAL2/dlt/trainers/cal_trainer2.py", line 148, in train
    self.train_epoch_CAL(epoch)
  File "/home/mineslab-ubuntu/KDH_CAL2/dlt/trainers/cal_trainer2.py", line 214, in train_epoch_CAL
    geometry_predict = self.model(batch, noisy_batch, t)
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/mineslab-ubuntu/KDH_CAL2/dlt/models/CAL.py", line 126, in forward
    output = self.seqTransEncoder(xseq, src_key_padding_mask = key_padding_mask)[1:] #time step embedding 제외
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/torch/nn/modules/transformer.py", line 280, in forward
    output = mod(output, src_mask=mask, src_key_padding_mask=src_key_padding_mask_for_layers)
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/torch/nn/modules/transformer.py", line 539, in forward
    x = self.norm2(x + self._ff_block(x))
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1192, in _call_impl
    if not (self._backward_hooks or self._forward_hooks or self._forward_pre_hooks or _global_backward_hooks
KeyboardInterrupt