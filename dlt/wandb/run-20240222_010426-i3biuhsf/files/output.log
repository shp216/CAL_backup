



Epoch 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:19<00:00, 11.32it/s, loss=0.0907, lr=4.7e-5, step=47]I0222 01:05:19.359270 140005170950528 cal_trainer2.py:313] Epoch 0, Avg Validation Loss: 0.0711930717031161, Avg Mean IoU: 0.058782171458005905
Epoch 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:48<00:00,  1.02s/it, loss=0.0907, lr=4.7e-5, step=47]
I0222 01:05:19.360634 140005170950528 logging.py:61] Saving current state to logs/test/checkpoints/checkpoint-0/
W0222 01:05:19.362883 140005170950528 logging.py:61] Removed shared tensor {'embed_timestep.seq_pos_enc.pe'} while saving. This should be OK, but check by verifying that you don't receive any warning while reloading
I0222 01:05:19.647693 140005170950528 logging.py:61] Model weights saved in logs/test/checkpoints/checkpoint-0/model.safetensors
I0222 01:05:20.074155 140005170950528 logging.py:61] Optimizer state saved in logs/test/checkpoints/checkpoint-0/optimizer.bin
I0222 01:05:20.075194 140005170950528 logging.py:61] Scheduler state saved in logs/test/checkpoints/checkpoint-0/scheduler.bin
I0222 01:05:20.075476 140005170950528 logging.py:61] Sampler state for dataloader 0 saved in logs/test/checkpoints/checkpoint-0/sampler.bin
I0222 01:05:20.075677 140005170950528 logging.py:61] Sampler state for dataloader 1 saved in logs/test/checkpoints/checkpoint-0/sampler_1.bin
I0222 01:05:20.079157 140005170950528 logging.py:61] Random states saved in logs/test/checkpoints/checkpoint-0/random_states_0.pkl
I0222 01:05:20.291415 140005170950528 cal_trainer2.py:349] Saving checkpoint to logs/test/checkpoints/checkpoint-0/

Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.51it/s, loss=0.0784, lr=9.4e-5, step=94]I0222 01:05:24.712333 140005170950528 cal_trainer2.py:313] Epoch 1, Avg Validation Loss: 0.06616320461034775, Avg Mean IoU: 0.08472000807523727
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.63it/s, loss=0.0784, lr=9.4e-5, step=94]

Epoch 2: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.58it/s, loss=0.0684, lr=0.000141, step=141]I0222 01:05:29.045644 140005170950528 cal_trainer2.py:313] Epoch 2, Avg Validation Loss: 0.06983493268489838, Avg Mean IoU: 0.06869273632764816
Epoch 2: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.85it/s, loss=0.0684, lr=0.000141, step=141]


Epoch 3: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.41it/s, loss=0.0546, lr=0.000188, step=188]I0222 01:05:33.430491 140005170950528 cal_trainer2.py:313] Epoch 3, Avg Validation Loss: 0.06655237327019374, Avg Mean IoU: 0.07294397056102753
Epoch 3: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.72it/s, loss=0.0546, lr=0.000188, step=188]

Epoch 4: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.48it/s, loss=0.0545, lr=0.000235, step=235]I0222 01:05:37.790099 140005170950528 cal_trainer2.py:313] Epoch 4, Avg Validation Loss: 0.05624157811204592, Avg Mean IoU: 0.09553080797195435
Epoch 4: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.79it/s, loss=0.0545, lr=0.000235, step=235]

Epoch 5: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.28it/s, loss=0.0441, lr=0.000282, step=282]I0222 01:05:42.246266 140005170950528 cal_trainer2.py:313] Epoch 5, Avg Validation Loss: 0.05197198564807574, Avg Mean IoU: 0.08015251159667969
Epoch 5: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.55it/s, loss=0.0441, lr=0.000282, step=282]

Epoch 6: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.98it/s, loss=0.0437, lr=0.000329, step=329]I0222 01:05:46.644848 140005170950528 cal_trainer2.py:313] Epoch 6, Avg Validation Loss: 0.04197652513782183, Avg Mean IoU: 0.08282183110713959
Epoch 6: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.69it/s, loss=0.0437, lr=0.000329, step=329]

Epoch 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.48it/s, loss=0.046, lr=0.000376, step=376]I0222 01:05:50.951470 140005170950528 cal_trainer2.py:313] Epoch 7, Avg Validation Loss: 0.04296092068155607, Avg Mean IoU: 0.15852190554141998
Epoch 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.92it/s, loss=0.046, lr=0.000376, step=376]

Epoch 8: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.38it/s, loss=0.0394, lr=0.000423, step=423]I0222 01:05:55.328331 140005170950528 cal_trainer2.py:313] Epoch 8, Avg Validation Loss: 0.03753628581762314, Avg Mean IoU: 0.1647660881280899
Epoch 8: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.74it/s, loss=0.0394, lr=0.000423, step=423]


Epoch 9: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.54it/s, loss=0.0373, lr=0.00047, step=470]I0222 01:05:59.694540 140005170950528 cal_trainer2.py:313] Epoch 9, Avg Validation Loss: 0.037926286458969116, Avg Mean IoU: 0.10354351252317429
Epoch 9: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.77it/s, loss=0.0373, lr=0.00047, step=470]

Epoch 10: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.49it/s, loss=0.0409, lr=0.000517, step=517]I0222 01:06:04.048532 140005170950528 cal_trainer2.py:313] Epoch 10, Avg Validation Loss: 0.04217778891324997, Avg Mean IoU: 0.11769793182611465
Epoch 10: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.80it/s, loss=0.0409, lr=0.000517, step=517]

Epoch 11: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.54it/s, loss=0.0325, lr=0.000564, step=564]I0222 01:06:08.398515 140005170950528 cal_trainer2.py:313] Epoch 11, Avg Validation Loss: 0.04399993146459261, Avg Mean IoU: 0.1198635846376419
Epoch 11: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.81it/s, loss=0.0325, lr=0.000564, step=564]

Epoch 12: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 12.33it/s, loss=0.0302, lr=0.000611, step=611]I0222 01:06:12.762954 140005170950528 cal_trainer2.py:313] Epoch 12, Avg Validation Loss: 0.03987348824739456, Avg Mean IoU: 0.1329735368490219
Epoch 12: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.77it/s, loss=0.0302, lr=0.000611, step=611]

Epoch 13: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.46it/s, loss=0.0418, lr=0.000658, step=658]I0222 01:06:17.074714 140005170950528 cal_trainer2.py:313] Epoch 13, Avg Validation Loss: 0.037720793237288795, Avg Mean IoU: 0.125059112906456
Epoch 13: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.91it/s, loss=0.0418, lr=0.000658, step=658]

Epoch 14: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.54it/s, loss=0.0407, lr=0.000705, step=705]I0222 01:06:21.426297 140005170950528 cal_trainer2.py:313] Epoch 14, Avg Validation Loss: 0.03945385292172432, Avg Mean IoU: 0.1559949517250061
Epoch 14: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.81it/s, loss=0.0407, lr=0.000705, step=705]


Epoch 15: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.26it/s, loss=0.0304, lr=0.000752, step=752]I0222 01:06:25.845170 140005170950528 cal_trainer2.py:313] Epoch 15, Avg Validation Loss: 0.03738864387075106, Avg Mean IoU: 0.13872748613357544
Epoch 15: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.64it/s, loss=0.0304, lr=0.000752, step=752]

Epoch 16: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.30it/s, loss=0.0379, lr=0.000799, step=799]I0222 01:06:30.298989 140005170950528 cal_trainer2.py:313] Epoch 16, Avg Validation Loss: 0.03819293901324272, Avg Mean IoU: 0.15956497192382812
Epoch 16: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.56it/s, loss=0.0379, lr=0.000799, step=799]

Epoch 17: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.35it/s, loss=0.0343, lr=0.000846, step=846]I0222 01:06:34.755360 140005170950528 cal_trainer2.py:313] Epoch 17, Avg Validation Loss: 0.040338318794965744, Avg Mean IoU: 0.1594892293214798
Epoch 17: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.55it/s, loss=0.0343, lr=0.000846, step=846]

Epoch 18: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.52it/s, loss=0.0447, lr=0.000893, step=893]I0222 01:06:39.113219 140005170950528 cal_trainer2.py:313] Epoch 18, Avg Validation Loss: 0.04328187803427378, Avg Mean IoU: 0.09439042955636978
Epoch 18: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.79it/s, loss=0.0447, lr=0.000893, step=893]

Epoch 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.29it/s, loss=0.0415, lr=0.00094, step=940]I0222 01:06:43.599510 140005170950528 cal_trainer2.py:313] Epoch 19, Avg Validation Loss: 0.04621790597836176, Avg Mean IoU: 0.11698991060256958
Epoch 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.48it/s, loss=0.0415, lr=0.00094, step=940]


Epoch 20: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.95it/s, loss=0.0621, lr=0.000987, step=987]I0222 01:06:47.966111 140005170950528 cal_trainer2.py:313] Epoch 20, Avg Validation Loss: 0.06910014897584915, Avg Mean IoU: 0.14154772460460663
Epoch 20: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.77it/s, loss=0.0621, lr=0.000987, step=987]

Epoch 21: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.35it/s, loss=0.0825, lr=0.001, step=1034]I0222 01:06:52.371433 140005170950528 cal_trainer2.py:313] Epoch 21, Avg Validation Loss: 0.07914932817220688, Avg Mean IoU: 0.04458880051970482
Epoch 21: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.67it/s, loss=0.0825, lr=0.001, step=1034]

Epoch 22: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 12.39it/s, loss=0.0762, lr=0.001, step=1081]I0222 01:06:56.718759 140005170950528 cal_trainer2.py:313] Epoch 22, Avg Validation Loss: 0.07634296516577403, Avg Mean IoU: 0.05938161909580231
Epoch 22: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.82it/s, loss=0.0762, lr=0.001, step=1081]

Epoch 23: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.23it/s, loss=0.0721, lr=0.001, step=1128]I0222 01:07:01.149735 140005170950528 cal_trainer2.py:313] Epoch 23, Avg Validation Loss: 0.07787637164195378, Avg Mean IoU: 0.06525004655122757
Epoch 23: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.61it/s, loss=0.0721, lr=0.001, step=1128]


Epoch 24: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.36it/s, loss=0.0893, lr=0.001, step=1175]I0222 01:07:05.529206 140005170950528 cal_trainer2.py:313] Epoch 24, Avg Validation Loss: 0.07875829190015793, Avg Mean IoU: 0.05287547409534454
Epoch 24: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.74it/s, loss=0.0893, lr=0.001, step=1175]

Epoch 25: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.57it/s, loss=0.0772, lr=0.001, step=1222]I0222 01:07:09.871187 140005170950528 cal_trainer2.py:313] Epoch 25, Avg Validation Loss: 0.07843746989965439, Avg Mean IoU: 0.07077808678150177
Epoch 25: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.83it/s, loss=0.0772, lr=0.001, step=1222]

Epoch 26: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.43it/s, loss=0.0796, lr=0.001, step=1269]I0222 01:07:14.268967 140005170950528 cal_trainer2.py:313] Epoch 26, Avg Validation Loss: 0.0767960324883461, Avg Mean IoU: 0.06493251770734787
Epoch 26: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.69it/s, loss=0.0796, lr=0.001, step=1269]

Epoch 27: 100%|█████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.26it/s, loss=0.079, lr=0.001, step=1316]I0222 01:07:18.669474 140005170950528 cal_trainer2.py:313] Epoch 27, Avg Validation Loss: 0.07659374177455902, Avg Mean IoU: 0.055981893092393875
Epoch 27: 100%|█████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.69it/s, loss=0.079, lr=0.001, step=1316]

Epoch 28: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 11.27it/s, loss=0.0778, lr=0.001, step=1363]I0222 01:07:23.138349 140005170950528 cal_trainer2.py:313] Epoch 28, Avg Validation Loss: 0.07637098431587219, Avg Mean IoU: 0.05515972897410393
Epoch 28: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.52it/s, loss=0.0778, lr=0.001, step=1363]

Epoch 29: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.93it/s, loss=0.0753, lr=0.001, step=1410]I0222 01:07:27.530989 140005170950528 cal_trainer2.py:313] Epoch 29, Avg Validation Loss: 0.07649219284454982, Avg Mean IoU: 0.06323014199733734
Epoch 29: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:04<00:00, 10.70it/s, loss=0.0753, lr=0.001, step=1410]



Epoch 30: 100%|█████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:23<00:00, 11.16it/s, loss=0.074, lr=0.001, step=1457]I0222 01:08:16.089640 140005170950528 cal_trainer2.py:313] Epoch 30, Avg Validation Loss: 0.07605552424987157, Avg Mean IoU: 0.0581589974462986
Epoch 30: 100%|█████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:48<00:00,  1.03s/it, loss=0.074, lr=0.001, step=1457]

Epoch 31:  34%|███████████████████████████████▎                                                            | 16/47 [00:15<00:02, 11.96it/s, loss=0.0831, lr=0.001, step=1473]Traceback (most recent call last):
  File "/home/mineslab-ubuntu/KDH_CAL2/dlt/main.py", line 119, in <module>
    app.run(main)
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/absl/app.py", line 308, in run
    _run_main(main, args)
  File "/home/mineslab-ubuntu/anaconda3/envs/DLT/lib/python3.9/site-packages/absl/app.py", line 254, in _run_main
    sys.exit(main(argv))
  File "/home/mineslab-ubuntu/KDH_CAL2/dlt/main.py", line 94, in main
    TrainLoopCAL(accelerator=accelerator, model=model, diffusion=noise_scheduler,
  File "/home/mineslab-ubuntu/KDH_CAL2/dlt/trainers/cal_trainer2.py", line 148, in train
    self.train_epoch_CAL(epoch)
  File "/home/mineslab-ubuntu/KDH_CAL2/dlt/trainers/cal_trainer2.py", line 228, in train_epoch_CAL
    true_box, pred_box = transform(true_geometry[:,:,:4], pred_geometry[:,:,:4], self.scaling_size)
  File "/home/mineslab-ubuntu/KDH_CAL2/dlt/evaluation/iou.py", line 7, in transform
    real_geometry = real_geometry[torch.any(real_geometry != 0, dim=-1)]
KeyboardInterrupt